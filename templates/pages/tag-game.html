<div id="page-tag-game" class="page-view">
  <!-- 헤더 -->
  <div class="page-header">
    <div>
      <div class="page-title">술래뽑기</div>
      <div class="page-subtitle">술래와 천사를 랜덤으로 뽑습니다</div>
    </div>
  </div>

  <!-- 라운드 표시 (Phase 2/3) -->
  <div id="tag-round-display" class="tag-round-display" style="display: none">ROUND 1</div>

  <!-- ============ Phase 1: 설정 화면 ============ -->
  <div id="tag-phase1">
    <!-- 뽑기 설정 카드 -->
    <div class="section">
      <div class="section-title" style="justify-content: space-between">
        <span>⚙️ 뽑기 설정</span>
        <div style="display: flex; align-items: center; gap: var(--space-sm); flex-shrink: 0">
          <span
            style="font-size: var(--font-size-sm); color: var(--text-secondary); font-weight: 500"
            >중복 제외</span
          >
          <label class="toggle">
            <input type="checkbox" id="tag-exclude-prev" />
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
      <div class="glass-card" style="padding: var(--space-lg)">
        <!-- 술래 수 / 천사 수 / 분 / 초 (2×2) -->
        <div class="tag-settings-4col">
          <div class="tag-setting-item">
            <div class="setting-label">술래 수</div>
            <div class="number-stepper">
              <button class="stepper-btn" data-target="tag-it-count" data-dir="down">−</button>
              <input type="number" id="tag-it-count" value="1" min="0" max="10" />
              <button class="stepper-btn" data-target="tag-it-count" data-dir="up">+</button>
            </div>
          </div>
          <div class="tag-setting-item">
            <div class="setting-label">천사 수</div>
            <div class="number-stepper">
              <button class="stepper-btn" data-target="tag-angel-count" data-dir="down">−</button>
              <input type="number" id="tag-angel-count" value="0" min="0" max="10" />
              <button class="stepper-btn" data-target="tag-angel-count" data-dir="up">+</button>
            </div>
          </div>
          <div class="tag-setting-item">
            <div class="setting-label">분</div>
            <div class="number-stepper">
              <button class="stepper-btn" data-target="tag-timer-min" data-dir="down">−</button>
              <input type="number" id="tag-timer-min" value="0" min="0" max="10" />
              <button class="stepper-btn" data-target="tag-timer-min" data-dir="up">+</button>
            </div>
          </div>
          <div class="tag-setting-item">
            <div class="setting-label">초</div>
            <div class="number-stepper">
              <button class="stepper-btn" data-target="tag-timer-sec" data-dir="down">−</button>
              <input type="number" id="tag-timer-sec" value="30" min="0" max="59" />
              <button class="stepper-btn" data-target="tag-timer-sec" data-dir="up">+</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 뽑을 학생 설정 카드 -->
    <div class="section">
      <div class="section-title">📋 뽑을 학생 설정</div>
      <div class="glass-card" style="padding: var(--space-lg)">
        <!-- 학생 수 (hidden, JS에서 참조용) -->
        <input type="hidden" id="tag-student-count" value="20" />

        <!-- 3개 버튼: 번호순 생성 / 학급 불러오기 / 성별 구분 -->
        <div class="tag-student-gen-buttons">
          <button class="btn btn-secondary btn-sm" id="tag-gen-by-number">📝 번호순 생성</button>
          <button class="btn btn-secondary btn-sm" id="tag-gen-by-class">📋 학급 불러오기</button>
          <button class="btn btn-secondary btn-sm" id="tag-gen-by-gender">👫 성별 구분</button>
        </div>

        <!-- 학생 카드 영역 (조건부 표시) -->
        <div id="tag-student-cards-wrapper" style="display: none">
          <div id="tag-student-cards" class="tag-student-cards"></div>
        </div>

        <!-- 학생 없을 때 안내 -->
        <div id="tag-no-students-message" class="tag-empty-message">
          <p
            style="
              font-size: var(--font-size-sm);
              color: var(--text-tertiary);
              text-align: center;
              padding: var(--space-lg);
            "
          >
            위 버튼으로 학생을 추가해주세요
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Phase 1 전용 버튼 -->
  <div id="tag-phase1-actions" class="tag-action-buttons">
    <button class="btn btn-primary" id="tag-start-btn">🎮 술래 뽑기!</button>
    <button class="btn btn-secondary" id="tag-back-to-result-btn" style="display: none">
      📊 결과로 돌아가기
    </button>
    <button class="btn btn-danger" id="tag-reset-from-settings-btn" style="display: none">
      🧹 초기화
    </button>
  </div>

  <!-- ============ Phase 2: 결과 섹션 ============ -->
  <div id="tag-result-section" style="display: none">
    <div class="section">
      <div class="section-title">🎯 뽑힌 결과</div>
      <div id="tag-result-container" class="tag-result-container"></div>
    </div>
  </div>

  <!-- ============ Phase 2: 후보/이력 (폴딩식) ============ -->
  <div id="tag-phase2-content" style="display: none">
    <!-- 후보 섹션 -->
    <div class="section">
      <div class="tag-collapsible">
        <button class="tag-collapse-toggle" data-target="tag-next-its">
          <span>🏃 다음 술래 후보 (<span id="tag-next-its-count">0</span>명)</span>
          <span class="collapse-arrow">▼</span>
        </button>
        <div id="tag-next-its" class="tag-collapse-content" style="display: none"></div>
      </div>
      <div class="tag-collapsible">
        <button class="tag-collapse-toggle" data-target="tag-next-angels">
          <span>😇 다음 천사 후보 (<span id="tag-next-angels-count">0</span>명)</span>
          <span class="collapse-arrow">▼</span>
        </button>
        <div id="tag-next-angels" class="tag-collapse-content" style="display: none"></div>
      </div>
    </div>

    <!-- 이력 섹션 -->
    <div class="section">
      <div class="tag-collapsible">
        <button class="tag-collapse-toggle" data-target="tag-history-its">
          <span>📜 지난 술래 (<span id="tag-history-its-count">0</span>명)</span>
          <span class="collapse-arrow">▼</span>
        </button>
        <div id="tag-history-its" class="tag-collapse-content" style="display: none"></div>
      </div>
      <div class="tag-collapsible">
        <button class="tag-collapse-toggle" data-target="tag-history-angels">
          <span>📜 지난 천사 (<span id="tag-history-angels-count">0</span>명)</span>
          <span class="collapse-arrow">▼</span>
        </button>
        <div id="tag-history-angels" class="tag-collapse-content" style="display: none"></div>
      </div>
    </div>
  </div>

  <!-- Phase 2: 뱃지 부여 버튼 -->
  <div id="tag-badge-area" style="display: none; text-align: center">
    <button class="tag-badge-btn" id="tag-badge-btn">🏅 뱃지 부여</button>
  </div>

  <!-- Phase 2 전용 버튼 -->
  <div id="tag-phase2-actions" class="tag-phase2-grid" style="display: none">
    <button class="btn btn-primary" id="tag-timer-start-btn">🎮 게임 시작</button>
    <button class="btn btn-secondary" id="tag-pick-again-btn">🎲 다시뽑기</button>
    <button class="btn btn-secondary" id="tag-modify-btn">✏️ 설정</button>
    <button class="btn btn-danger" id="tag-new-game-btn">🧹 초기화</button>
  </div>

  <!-- ============ Phase 3: 타이머 ============ -->
  <div id="tag-timer-phase" class="tag-timer-phase" style="display: none">
    <div class="tag-timer-display-wrapper">
      <div class="tag-timer-label">남은 시간</div>
      <div id="tag-timer-display" class="tag-timer-display timer-normal">00:00</div>
    </div>
    <!-- 전체화면 타이머 내 휘슬 버튼 -->
    <div id="tag-timer-whistle" class="timer-whistle-wrap">
      <button class="timer-whistle-btn" id="tag-timer-whistle-btn">
        <span class="timer-whistle-btn__icon">📣</span>
      </button>
      <div class="timer-whistle-ring" id="tag-timer-whistle-ring1"></div>
      <div class="timer-whistle-ring" id="tag-timer-whistle-ring2"></div>
      <div class="timer-whistle-mode-row">
        <button class="timer-whistle-mode" data-mode="hold" data-whistle-mode>꾹</button>
        <button
          class="timer-whistle-mode timer-whistle-mode--active"
          data-mode="long"
          data-whistle-mode
        >
          삐—
        </button>
        <button class="timer-whistle-mode" data-mode="triple" data-whistle-mode>삐삐삐</button>
      </div>
    </div>
    <div class="tag-timer-sub-controls">
      <button class="btn btn-sm btn-secondary" id="tag-timer-fullscreen-toggle">축소</button>
      <button class="btn btn-sm btn-secondary" id="tag-timer-pause">⏸️ 일시정지</button>
      <button class="btn btn-sm btn-danger" id="tag-timer-end">타이머 종료</button>
    </div>
  </div>
</div>
